# Generated by Django 4.0.6 on 2022-12-15 03:16

from django.db import migrations
import requests


def update(apps, schema_editor):
    Team = apps.get_model('api', 'Team')
    
    for team in get_teams():
      Team.objects.filter(abbreviation=team['teamAbbrev']['default']).update(
        official_site_url=f"https://www.nhl.com/{team['teamCommonName']['default'].lower().replace(' ', '')}/"
      )

def get_teams():
    response = requests.get('https://api-web.nhle.com/v1/standings/now')
    return response.json()['standings']

class Migration(migrations.Migration):

    dependencies = [
        ('api', '0003_team_official_site_url'),
    ]

    operations = [
        migrations.RunPython(update),
    ]
